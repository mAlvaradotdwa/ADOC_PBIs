table MK_LOTES
	lineageTag: 64b47367-bc58-4acc-9dd7-851cf92ad17c

	column LOTE
		dataType: string
		lineageTag: 98461ed7-bc12-4f62-87cf-9ca79b0d79f3
		summarizeBy: none
		sourceColumn: LOTE

		annotation SummarizationSetBy = Automatic

	column MK
		dataType: string
		lineageTag: 9a44f11b-5acd-4120-a43f-f90d0136393d
		summarizeBy: none
		sourceColumn: MK

		annotation SummarizationSetBy = Automatic

	column ZINSTOREDATE_MK
		dataType: string
		lineageTag: 35bee1c5-63f7-4499-ba97-2df80ae05f76
		summarizeBy: none
		sourceColumn: ZINSTOREDATE_MK

		annotation SummarizationSetBy = Automatic

	column INDICADOR_DE_LIBERACION
		dataType: string
		lineageTag: cd183034-34ae-4c83-8e52-e66bcf62ed99
		summarizeBy: none
		sourceColumn: INDICADOR_DE_LIBERACION

		annotation SummarizationSetBy = Automatic

	column GRUPO_DE_LIBERACION
		dataType: string
		lineageTag: 46691622-6576-46ae-996f-9e7587e63ac9
		summarizeBy: none
		sourceColumn: GRUPO_DE_LIBERACION

		annotation SummarizationSetBy = Automatic

	column ESTRATEGIA_LIBERACION
		dataType: string
		lineageTag: da4510a4-75e5-436c-b6cc-3efb6f31b255
		summarizeBy: none
		sourceColumn: ESTRATEGIA_LIBERACION

		annotation SummarizationSetBy = Automatic

	column TIPO_DOCUMENTO
		dataType: string
		lineageTag: e896e745-231d-4820-bf0f-b9707c12525d
		summarizeBy: none
		sourceColumn: TIPO_DOCUMENTO

		annotation SummarizationSetBy = Automatic

	column DOCUMENTO
		dataType: string
		lineageTag: 914cfc28-8f61-4c35-893b-42512219356f
		summarizeBy: none
		sourceColumn: DOCUMENTO

		annotation SummarizationSetBy = Automatic

	column ARTICULO
		dataType: string
		lineageTag: 4e70fc13-617e-4d26-af1c-3de4184a3f02
		summarizeBy: none
		sourceColumn: ARTICULO

		annotation SummarizationSetBy = Automatic

	column DESCRIPCION
		dataType: string
		lineageTag: ee87eb90-3681-4e09-86f2-8dc89f4066be
		summarizeBy: none
		sourceColumn: DESCRIPCION

		annotation SummarizationSetBy = Automatic

	column CANTIDAD
		dataType: double
		lineageTag: 86c96b9e-336b-4daf-8240-167f96d44e25
		summarizeBy: sum
		sourceColumn: CANTIDAD

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column ALMACEN
		dataType: string
		lineageTag: c2dd949d-0f4e-4c79-8de9-89cc8c0e99fd
		summarizeBy: none
		sourceColumn: ALMACEN

		annotation SummarizationSetBy = Automatic

	column CANTIDAD_PARES
		dataType: double
		lineageTag: c97d72b9-96b1-4c53-b0f5-2c5397981eda
		summarizeBy: sum
		sourceColumn: CANTIDAD_PARES

		annotation SummarizationSetBy = Automatic

		annotation PBI_FormatHint = {"isGeneralNumber":true}

	column PE
		dataType: string
		lineageTag: 9fd0f162-7b70-4409-901f-4db9f20ec4dc
		summarizeBy: none
		sourceColumn: PE

		annotation SummarizationSetBy = Automatic

	column ANO_PE
		dataType: string
		lineageTag: df84f4a1-02f2-41db-98b5-03e3c38de9e9
		summarizeBy: none
		sourceColumn: ANO_PE

		annotation SummarizationSetBy = Automatic

	column FECHA_CREACION
		dataType: string
		lineageTag: a52122b4-6f3f-4bb1-a6bd-26d21be46a19
		summarizeBy: none
		sourceColumn: FECHA_CREACION

		annotation SummarizationSetBy = Automatic

	column FECHA_CREACION2
		dataType: string
		lineageTag: 133bf362-051a-4ab5-8223-dd966cc304ad
		summarizeBy: none
		sourceColumn: FECHA_CREACION2

		annotation SummarizationSetBy = Automatic

	column XFACTORY_ACTUALIZADO
		dataType: string
		lineageTag: db0a6e09-a017-4044-9c6f-4ca81fe5eacb
		summarizeBy: none
		sourceColumn: XFACTORY_ACTUALIZADO

		annotation SummarizationSetBy = Automatic

	column XFACTORY_ORIGINAL
		dataType: string
		lineageTag: 463387a2-129f-4763-a619-ad2b00e2fe40
		summarizeBy: none
		sourceColumn: XFACTORY_ORIGINAL

		annotation SummarizationSetBy = Automatic

	column ENTIDAD_CD
		dataType: string
		lineageTag: 443430ee-bfb8-4dad-ab09-88996c59df73
		summarizeBy: none
		sourceColumn: ENTIDAD_CD

		annotation SummarizationSetBy = Automatic

	column ENTIDAD_SOLICITANTE
		dataType: string
		lineageTag: 22642d81-a07b-4687-82f2-1e1d4a12d017
		summarizeBy: none
		sourceColumn: ENTIDAD_SOLICITANTE

		annotation SummarizationSetBy = Automatic

	column CENTRO_DESTINO_FINAL
		dataType: string
		lineageTag: a6187f98-8b1a-4806-bf73-7ac52a01ccfe
		summarizeBy: none
		sourceColumn: CENTRO_DESTINO_FINAL

		annotation SummarizationSetBy = Automatic

	column FECHA_TIENDA
		dataType: string
		lineageTag: f5d7a963-037b-4f33-a6a9-9ea49c17a0da
		summarizeBy: none
		sourceColumn: FECHA_TIENDA

		annotation SummarizationSetBy = Automatic

	column XFACTORY_REQUERIDA
		dataType: string
		lineageTag: e8f09a88-4eba-4688-b108-a56419a5989e
		summarizeBy: none
		sourceColumn: XFACTORY_REQUERIDA

		annotation SummarizationSetBy = Automatic

	column FECHA_EKKO
		dataType: string
		lineageTag: a01f515b-aa93-4145-8089-6912f70434e5
		summarizeBy: none
		sourceColumn: FECHA_EKKO

		annotation SummarizationSetBy = Automatic

	column NUMERO_PROVEEDOR
		dataType: string
		lineageTag: 1dba178b-cf56-4499-81eb-e4efef9d991e
		summarizeBy: none
		sourceColumn: NUMERO_PROVEEDOR

		annotation SummarizationSetBy = Automatic

	column INCOTERM
		dataType: string
		lineageTag: a3e5096c-be3c-47e5-a4c9-238fceeeb5ed
		summarizeBy: none
		sourceColumn: INCOTERM

		annotation SummarizationSetBy = Automatic

	column PUERTO_ORIGEN
		dataType: string
		lineageTag: 7af855de-48b4-4f5d-a80f-2da015c85dd9
		summarizeBy: none
		sourceColumn: PUERTO_ORIGEN

		annotation SummarizationSetBy = Automatic

	column FECHA_DESPACHO_FINAL
		dataType: string
		lineageTag: 9acb8b3f-f461-4e0c-bef0-458d3f1f6d8e
		summarizeBy: none
		sourceColumn: FECHA_DESPACHO_FINAL

		annotation SummarizationSetBy = Automatic

	column FECHA_DESPACHO_INICIAL
		dataType: string
		lineageTag: 6e5b41c7-d06f-4655-bf1b-a4bab5305b73
		summarizeBy: none
		sourceColumn: FECHA_DESPACHO_INICIAL

		annotation SummarizationSetBy = Automatic

	column TIPO_DE_FLETE
		dataType: string
		lineageTag: 4b8a026f-148a-48bc-9996-2a66efae9c01
		summarizeBy: none
		sourceColumn: TIPO_DE_FLETE

		annotation SummarizationSetBy = Automatic

	column PUERTO_ORIGEN2
		dataType: string
		lineageTag: 12fd2b76-b5b9-4f6c-8e69-6c99633d8a08
		summarizeBy: none
		sourceColumn: PUERTO_ORIGEN2

		annotation SummarizationSetBy = Automatic

	column ENTIDAD_COMPRA
		dataType: string
		lineageTag: 0250fa2e-0073-45aa-ada6-69a7c2da6bd2
		summarizeBy: none
		sourceColumn: ENTIDAD_COMPRA

		annotation SummarizationSetBy = Automatic

	column ENTIDAD_SOLICITANTE2
		dataType: string
		lineageTag: 1c8f9efa-aed1-4ab5-9820-153b7667be05
		summarizeBy: none
		sourceColumn: ENTIDAD_SOLICITANTE2

		annotation SummarizationSetBy = Automatic

	column ENTIDAD_CD2
		dataType: string
		lineageTag: f4d4e3e0-dc89-44d4-9660-14e5195d5ef4
		summarizeBy: none
		sourceColumn: ENTIDAD_CD2

		annotation SummarizationSetBy = Automatic

	column ZIMP
		dataType: string
		lineageTag: 93e07e21-4433-4493-85b7-8c86ad5da40a
		summarizeBy: none
		sourceColumn: ZIMP

		annotation SummarizationSetBy = Automatic

	column ZIMP_POS
		dataType: string
		lineageTag: 47deccab-ba94-468b-8320-eacf242df724
		summarizeBy: none
		sourceColumn: ZIMP_POS

		annotation SummarizationSetBy = Automatic

	column MK_POS
		dataType: string
		lineageTag: e4023104-b094-4d70-9016-16c959c62c0f
		summarizeBy: none
		sourceColumn: MK_POS

		annotation SummarizationSetBy = Automatic

	column MATNR
		dataType: string
		lineageTag: 2c70316e-dd4d-4be3-91a7-f2e035318234
		summarizeBy: none
		sourceColumn: MATNR

		annotation SummarizationSetBy = Automatic

	column ZCENTRODES
		dataType: string
		lineageTag: a5f77ba9-c3fd-4d75-8a59-106e9edff12d
		summarizeBy: none
		sourceColumn: ZCENTRODES

		annotation SummarizationSetBy = Automatic

	column AEDAT_MK
		dataType: string
		lineageTag: b16da739-7297-4cf2-a0ba-fd7502d2245d
		summarizeBy: none
		sourceColumn: AEDAT_MK

		annotation SummarizationSetBy = Automatic

	column ZFACTORY_MK
		dataType: string
		lineageTag: 3acda2a5-4b69-46d2-97ed-a104bc26d598
		summarizeBy: none
		sourceColumn: ZFACTORY_MK

		annotation SummarizationSetBy = Automatic

	partition MK_LOTES = m
		mode: import
		source =
				let
				    Consulta1 = Value.NativeQuery(SapHana.Database("vhadoahpdb01.hec.empresasadoc.com:30215", [Implementation="2.0"]), "WITH ZIMPs AS (#(lf)    -- recosntrucción de mk para pre-packs#(lf)    SELECT#(lf)        pn.EBELN ZIMP ,#(lf)        pn.EBELP ZIMP_POS ,#(lf)        COALESCE ( NULLIF ( pn.KONNR , '' ) , p0.KONNR  ) MK ,#(lf)        COALESCE ( NULLIF ( pn.KTPNR , '00000'  ) , p0.KTPNR  ) MK_POS ,#(lf)        pn.MATNR #(lf)    FROM SAP_ECC.EKPO pn#(lf)    LEFT JOIN SAP_ECC.EKPO p0#(lf)        ON p0.EBELN = pn.EBELN #(lf)        AND p0.EBELP = pn.UEBPO #(lf)    WHERE pn.LOEKZ <> 'L'#(lf)         -- AND pn.EBELN = 4500038208 #(lf)),#(lf)DatosMK AS (#(lf)    SELECT #(lf)        z.* , #(lf)        k.INCO2 Puerto_Origen ,#(lf)        k.ZZ_ZPORT Puerto_Origen2 ,#(lf)        l.CHARG LOTE ,#(lf)        e.ZCENTRODES ,#(lf)        E.AEDAT AEDAT_MK ,#(lf)        e.ZFACTORY ZFACTORY_MK,#(lf)        e.ZINSTOREDATE ZINSTOREDATE_MK #(lf)    FROM ZIMPs z#(lf)    LEFT JOIN SAP_ECC.EKET l#(lf)        ON z.ZIMP  = l.EBELN #(lf)        AND z.ZIMP_POS = l.EBELP #(lf)    LEFT JOIN SAP_ECC.EKPO e #(lf)        ON z.MK = e.EBELN #(lf)        AND z.MK_POS = e.EBELP #(lf)    LEFT JOIN SAP_ECC.EKKO k#(lf)        ON z.MK = k.EBELN #(lf)    WHERE e.AEDAT >= 20240101#(lf)),#(lf)lotes AS (#(lf)    SELECT#(lf)        ek.CHARG ,#(lf)        EKPO.EBELN,#(lf)        EKPO.EBELP,#(lf)        EKPO.MATNR ,#(lf)        EKKO.FRGKE AS Indicador_de_Liberacion,#(lf)        EKKO.FRGGR AS Grupo_de_Liberacion,#(lf)        EKKO.FRGSX AS Estrategia_Liberacion,#(lf)        EKKO.BSART AS Tipo_Documento,  #(lf)        EKPO.EBELN AS Documento,#(lf)        EKPO.MATNR AS Articulo,#(lf)        EKPO.TXZ01 AS Descripcion, #(lf)        EKPO.MENGE AS Cantidad,#(lf)        EKPO.LGORT AS Almacen,#(lf)        CASE #(lf)            WHEN LEFT(EKPO.TXZ01, 7) = 'Prepack' #(lf)            THEN CAST(SUBSTRING_REGEXPR('(\d+)' IN EKPO.TXZ01 GROUP 1) AS INTEGER) #(lf)            ELSE 1 #(lf)        END * EKPO.MENGE AS Cantidad_Pares,#(lf)        EKPO.SAISO AS PE,#(lf)        EKPO.SAISO AS Ano_PE,#(lf)        EKPO.AEDAT AS Fecha_Creacion,#(lf)        EKPO.CREATIONDATE AS Fecha_Creacion2,#(lf)        EKPO.ZFACTORY AS XFactory_Actualizado, #(lf)        EKPO.ZFACTORYO AS XFactory_Original,#(lf)        EKPO.WERKS AS Entidad_CD,#(lf)        EKPO.BUKRS AS Entidad_Solicitante,#(lf)        EKPO.ZCENTRODES AS Centro_Destino_Final,#(lf)        EKPO.ZINSTOREDATE AS Fecha_Tienda,#(lf)        EKKO.ZZF_DESPACHO AS XFactory_Requerida,#(lf)        EKKO.AEDAT AS Fecha_EKKO,#(lf)        EKKO.LIFNR AS Numero_Proveedor, #(lf)        EKKO.INCO1 AS Incoterm,#(lf)--        EKKO.INCO2 AS Puerto_Origen,#(lf)        EKKO.ZZF_DESPACHO AS Fecha_Despacho_Final,#(lf)        EKKO.ZZF_DESPINI AS Fecha_Despacho_Inicial,#(lf)        EKKO.ZZ_TIPO_FLETE AS Tipo_de_Flete,#(lf)--        EKKO.ZZ_ZPORT AS Puerto_Origen2,#(lf)        EKKO.BUKRS AS Entidad_Compra,#(lf)        EKKO.EKORG AS Entidad_Solicitante2,#(lf)        EKKO.ZZ_CENTRO_D AS Entidad_CD2#(lf)    FROM SAP_ECC.EKET ek#(lf)    INNER JOIN SAP_ECC.EKPO EKPO#(lf)        ON ek.EBELN = EKPO.EBELN #(lf)        AND ek.EBELP = EKPO.EBELP #(lf)    INNER JOIN SAP_ECC.ekko EKKO#(lf)        ON EKPO.EBELN = EKKO.EBELN #(lf)    WHERE EKPO.LOEKZ <> 'L'#(lf)),#(lf)final_cte AS (#(lf)    SELECT #(lf)        m.*,#(lf)        Indicador_de_Liberacion,#(lf)        Grupo_de_Liberacion,#(lf)        Estrategia_Liberacion,#(lf)        Tipo_Documento,  #(lf)        Documento,#(lf)        Articulo,#(lf)        Descripcion, #(lf)        Cantidad,#(lf)        Almacen,#(lf)        Cantidad_Pares,#(lf)        PE,#(lf)        Ano_PE,#(lf)        Fecha_Creacion,#(lf)        Fecha_Creacion2,#(lf)        XFactory_Actualizado, #(lf)        XFactory_Original,#(lf)        Entidad_CD,#(lf)        Entidad_Solicitante,#(lf)        Centro_Destino_Final,#(lf)        Fecha_Tienda,#(lf)        XFactory_Requerida,#(lf)        Fecha_EKKO,#(lf)        Numero_Proveedor, #(lf)        Incoterm,#(lf)--        Puerto_Origen,#(lf)        Fecha_Despacho_Final,#(lf)        Fecha_Despacho_Inicial,#(lf)        Tipo_de_Flete,#(lf)--        Puerto_Origen2,#(lf)        Entidad_Compra,#(lf)        Entidad_Solicitante2,#(lf)        Entidad_CD2#(lf)    FROM DatosMK m#(lf)    INNER JOIN lotes l#(lf)        ON m.LOTE = l.CHARG #(lf)        AND m.ZIMP_POS  = l.EBELP #(lf)        AND m.MATNR = l.MATNR #(lf))#(lf)SELECT *#(lf)FROM final_cte#(lf)", null, [EnableFolding=true])
				in
				    Consulta1

	annotation PBI_NavigationStepName = Navegación

	annotation PBI_ResultType = Table

